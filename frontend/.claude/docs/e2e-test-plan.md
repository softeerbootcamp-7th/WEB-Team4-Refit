# E2E 테스트 플로우 계획서

> 작성일: 2026-02-24
> 프로젝트: Refit (면접 기록 & 회고 서비스)
> 도구: agent-browser (Playwright 기반)

---

## 1. 로그인 → 회원가입 플로우

### 목적

신규 유저의 첫 진입부터 대시보드 도달까지 전체 온보딩 경험 검증

### 사전 조건

- 로그아웃 상태 (세션 없음)
- Google OAuth 테스트 계정 준비

### 테스트 경로

```
/signin → Google OAuth 팝업 → /auth/callback → /signup → /dashboard
```

### 상세 스텝

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | `/signin` 접속 | 로그인 페이지 렌더링, "Google 계정으로 로그인" 버튼 노출 |
| 2 | Google 로그인 버튼 클릭 | OAuth 팝업 열림 |
| 3 | Google 계정 선택 및 인증 | 팝업에서 `/auth/callback` 처리 후 팝업 닫힘 |
| 4 | 회원가입 페이지 리다이렉트 확인 | `/signup` 도달, 닉네임 입력 폼 노출 |
| 5 | 닉네임 입력 (예: "테스트유저") | 입력값 반영, 20자 제한 동작 |
| 6 | 산업군 드롭다운 선택 | 선택 항목 반영 |
| 7 | 직군 드롭다운 선택 | 선택 항목 반영 |
| 8 | "시작하기" 버튼 클릭 | `/dashboard`로 리다이렉트 |
| 9 | 대시보드 렌더링 확인 | 메인 대시보드 컴포넌트 정상 노출 |

### 검증 포인트

- [ ] OAuth 팝업 정상 열림/닫힘
- [ ] 콜백 처리 후 세션 상태 `signup_required` 전환
- [ ] 회원가입 폼 유효성 검증 (닉네임 필수, 20자 제한)
- [ ] 가입 완료 후 세션 상태 `authenticated` 전환
- [ ] 대시보드 정상 도달

---

## 2. 대시보드 탐색 플로우

### 목적

대시보드 내 모든 주요 페이지 네비게이션과 데이터 로딩 검증

### 사전 조건

- 로그인 완료 상태 (`authenticated`)
- 약관 동의 완료

### 테스트 경로

```
/dashboard → /dashboard/my-interviews → /dashboard/trend-questions
→ /dashboard/my-collections → /dashboard/my-collections/:folderId
→ /dashboard/my-page
```

### 상세 스텝

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | `/dashboard` 접속 | 메인 대시보드 렌더링 (배너, 캘린더, 섹션) |
| 2 | 캘린더 날짜 이동 | 해당 월/주의 면접 일정 로딩 |
| 3 | "내 면접" 메뉴 클릭 | `/dashboard/my-interviews` 이동 |
| 4 | "면접" 탭 확인 | 면접 목록 렌더링 |
| 5 | "질문" 탭 전환 | 질문 목록 렌더링 |
| 6 | 필터/정렬 조작 | 목록 필터링 정상 동작 |
| 7 | "트렌드 질문" 메뉴 클릭 | `/dashboard/trend-questions` 이동, 인기 질문 목록 노출 |
| 8 | "내 모아보기" 메뉴 클릭 | `/dashboard/my-collections` 이동, 폴더 목록 노출 |
| 9 | "어려웠던 질문" 기본 폴더 클릭 | `/dashboard/my-collections/difficult-questions` 이동 |
| 10 | 새 폴더 생성 | 폴더 생성 후 목록에 반영 |
| 11 | 생성한 폴더 진입 | `/dashboard/my-collections/:folderId` 이동, 스크랩 목록 노출 |
| 12 | "마이페이지" 메뉴 클릭 | `/dashboard/my-page` 이동, 프로필 정보 노출 |

### 검증 포인트

- [ ] 모든 탭/메뉴 네비게이션 정상 동작
- [ ] 각 페이지 데이터 Suspense 로딩 → 렌더링 완료
- [ ] 캘린더 인터랙션 정상
- [ ] 폴더 CRUD 동작
- [ ] 스크롤 리셋 (DashboardLayout)

---

## 3. 면접 기록 파이프라인 플로우 (핵심)

### 목적

앱의 핵심 기능인 면접 기록 3단계 파이프라인 전체 검증

### 사전 조건

- 로그인 완료 상태
- 면접 일정이 1개 이상 존재 (상태: `NOT_LOGGED`)

### 테스트 경로

```
면접 생성/선택 → /record/:id (1단계: 기록)
→ /record/:id/confirm (2단계: Q&A 확인)
→ /record/:id/link (3단계: 연결)
```

### 상세 스텝

#### 3-1. 1단계: 기록 (`/record/:interviewId`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | 대시보드에서 기록할 면접 선택 | `/record/:id` 이동 |
| 2 | 페이지 렌더링 확인 | 텍스트 입력 영역, 사이드바 노출 |
| 3 | 면접 내용 텍스트 입력 | 입력값 반영 |
| 4 | 자동저장 동작 확인 | 디바운스 후 API 호출, 저장 표시 |
| 5 | "기록 완료" 버튼 클릭 | 상태 `NOT_LOGGED` → `LOG_DRAFT` 전환 |

#### 3-2. 2단계: Q&A 확인 (`/record/:interviewId/confirm`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 6 | 자동 Q&A 변환 결과 확인 | 질문-답변 쌍 목록 렌더링 |
| 7 | Q&A 항목 편집 | 수정 내용 반영 |
| 8 | Q&A 항목 추가 | 새 항목 추가됨 |
| 9 | Q&A 항목 삭제 | 항목 제거됨 |
| 10 | 사이드바 면접 정보 확인 | 회사명, 직무, 날짜 노출 |
| 11 | "확인 완료" 버튼 클릭 | 상태 `QNA_SET_DRAFT` 전환 |

#### 3-3. 3단계: 자소서 연결 & 하이라이팅 (`/record/:interviewId/link`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 12 | 연결 페이지 렌더링 확인 | 질문 탭(1번~N번) + PDF 업로드 영역 노출 |
| 13 | "자기소개서 불러오기" 클릭 → PDF 업로드 | PDF 뷰어에 자소서 렌더링, "자기소개서 연결하기" 버튼 활성화 |
| 14 | 1번 질문 탭 선택 → "자기소개서 연결하기" 클릭 | 연결 모드 진입 ("취소" / "연결 저장" 버튼 노출) |
| 15 | PDF 텍스트 영역 드래그하여 관련 내용 하이라이팅 | 선택 영역 하이라이트 표시, "연결 저장" 버튼 활성화 |
| 16 | "연결 저장" 클릭 | 1번 질문에 자소서 연결 완료, "초기화" 버튼으로 전환 |
| 17 | 2번 질문 탭 선택 → "자기소개서 연결하기" 클릭 | 2번 질문 연결 모드 진입 |
| 18 | PDF 텍스트 영역 드래그 → 하이라이팅 → "연결 저장" | 2번 질문 연결 완료 |
| 19 | "회고 하러 가기" 클릭 → 확인 모달 "이동하기" | `/retro/:id`로 이동 |

#### 3-4. 회고 페이지에서 PDF 연결 확인 (`/retro/:interviewId`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 20 | 회고 페이지 렌더링 확인 | Q&A 목록 + "자기소개서 pdf 열기" 버튼 노출 |
| 21 | "자기소개서 pdf 열기" 클릭 | PDF 뷰어 열림, 하이라이팅된 영역 표시 |
| 22 | 1번 질문 탭 선택 | PDF에서 1번 질문에 연결된 하이라이트 영역으로 이동 |
| 23 | 2번 질문 탭 선택 | PDF에서 2번 질문에 연결된 하이라이트 영역으로 이동 |

### 상태 전이 검증

```
NOT_LOGGED → LOG_DRAFT → QNA_SET_DRAFT → SELF_REVIEW_DRAFT
```

### 검증 포인트

- [ ] 각 단계 간 네비게이션 정상 동작
- [ ] 상태에 맞지 않는 URL 접근 시 올바른 단계로 리다이렉트
- [ ] 자동저장 (디바운스) 정상 동작
- [ ] Q&A 자동 변환 결과 렌더링
- [ ] PDF 업로드 및 뷰어 렌더링 정상 동작
- [ ] 질문별 자소서 하이라이팅 & 연결 저장
- [ ] 회고 페이지에서 PDF 열기 및 하이라이트 영역 확인
- [ ] Q&A CRUD 동작
- [ ] 상태 전이 순서 보장

---

## 4. 회고 플로우

### 목적

면접 기록 완료 후 회고(셀프 리뷰 + 디브리핑) 전체 과정 검증

### 사전 조건

- 로그인 완료 상태
- 면접 기록 3단계 완료 (상태: `SELF_REVIEW_DRAFT`)

### 테스트 경로

```
/retro/:id (셀프 리뷰) → /retro/:id/details (디브리핑 완료)
```

### 상세 스텝

#### 4-1. 셀프 리뷰 (`/retro/:interviewId`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | `/retro/:id` 접속 | 회고 메인 페이지 렌더링 |
| 2 | Q&A 섹션별 리뷰 확인 | 질문-답변 목록과 리뷰 입력 영역 노출 |
| 3 | 각 질문에 대한 셀프 리뷰 작성 | 리뷰 내용 반영 |
| 4 | KPT 분석 작성 (Keep/Problem/Try) | 각 항목 입력 및 반영 |
| 5 | STAR 분석 작성 (Situation/Task/Action/Result) | 각 항목 입력 및 반영 |
| 6 | 스크랩 기능 테스트 | 질문을 컬렉션에 스크랩 |
| 7 | 리뷰 완료 처리 | 다음 단계로 전환 |

#### 4-2. 디브리핑 (`/retro/:interviewId/details`)

| # | 액션 | 기대 결과 |
|---|------|----------|
| 8 | `/retro/:id/details` 이동 | 상세 디브리핑 페이지 렌더링 |
| 9 | 디브리핑 내용 확인/작성 | 최종 인사이트 정리 |
| 10 | 회고 완료 처리 | 상태 `DEBRIEF_COMPLETED` 전환 |
| 11 | 대시보드 복귀 | `/dashboard`에서 완료된 면접으로 표시 |

### 상태 전이 검증

```
SELF_REVIEW_DRAFT → DEBRIEF_COMPLETED
```

### 검증 포인트

- [ ] Q&A 기반 회고 UI 정상 렌더링
- [ ] KPT / STAR 분석 프레임워크 동작
- [ ] 스크랩 → 컬렉션 연동
- [ ] 디브리핑 완료 후 상태 최종 전환
- [ ] 완료된 면접의 대시보드 표시 상태

---

## 5. 모바일 플로우

### 목적

모바일 환경에서의 회원가입 및 면접 녹음 기능 검증

### 사전 조건

- 모바일 UA (또는 모바일 뷰포트)
- Web Speech API 지원 브라우저

### 테스트 경로

```
/mobile → 로그인 → /mobile/signup → /mobile/unrecorded → /mobile/record/:id
```

### 상세 스텝

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | 모바일 기기로 사이트 접속 | 자동으로 `/mobile` 리다이렉트 |
| 2 | 모바일 랜딩 페이지 확인 | "면접 기록 시작하기" 버튼 노출 |
| 3 | Google 로그인 진행 | OAuth 플로우 정상 동작 |
| 4 | (신규 유저) 모바일 회원가입 | `/mobile/signup`에서 정보 입력 |
| 5 | 미기록 면접 목록 확인 | `/mobile/unrecorded` 이동, 면접 리스트 노출 |
| 6 | 면접 선택 | `/mobile/record/:id` 이동 |
| 7 | Web Speech API 녹음 시작 | 마이크 권한 요청, 음성 인식 시작 |
| 8 | 음성 입력 → 텍스트 변환 확인 | 실시간 텍스트 반영 |
| 9 | 녹음 완료 | 기록 저장, 데스크톱에서 이어서 진행 안내 |

### 검증 포인트

- [ ] 데스크톱 URL 접근 시 모바일 리다이렉트 동작
- [ ] MobileLayout 정상 렌더링
- [ ] Web Speech API 지원 체크 (미지원 시 안내 메시지)
- [ ] 음성 → 텍스트 실시간 변환
- [ ] 모바일 ↔ 데스크톱 데이터 연동

---

## 6. 인증 / 권한 가드 테스트

### 목적

미들웨어 기반 인증 가드와 에러 페이지 동작 검증

### 사전 조건

- 비로그인 상태 + 로그인 상태 각각 테스트

### 테스트 경로

```
비인증 → /dashboard → /signin 리다이렉트
비인증 → /record/:id → /signin 리다이렉트
잘못된 상태 → /retro/:id → 올바른 단계 리다이렉트
존재하지 않는 면접 → /interview-not-found
존재하지 않는 경로 → 404 페이지
/forbidden 직접 접근 → 403 페이지
```

### 상세 스텝

#### 6-1. 비인증 상태 접근 차단

| # | 액션 | 기대 결과 |
|---|------|----------|
| 1 | 비로그인 상태에서 `/dashboard` 접근 | `/signin`으로 리다이렉트 |
| 2 | 비로그인 상태에서 `/record/123` 접근 | `/signin`으로 리다이렉트 |
| 3 | 비로그인 상태에서 `/retro/123` 접근 | `/signin`으로 리다이렉트 |

#### 6-2. 면접 상태 기반 라우트 가드

| # | 액션 | 기대 결과 |
|---|------|----------|
| 4 | `NOT_LOGGED` 상태 면접으로 `/retro/:id` 접근 | `/record/:id`로 리다이렉트 |
| 5 | `QNA_SET_DRAFT` 상태 면접으로 `/record/:id` 접근 | `/record/:id/confirm`으로 리다이렉트 |
| 6 | `DEBRIEF_COMPLETED` 상태 면접으로 `/record/:id` 접근 | `/retro/:id/details`로 리다이렉트 |

#### 6-3. 에러 페이지

| # | 액션 | 기대 결과 |
|---|------|----------|
| 7 | 존재하지 않는 면접 ID로 접근 | `/interview-not-found` 페이지 노출 |
| 8 | `/forbidden` 접근 | 403 Forbidden 페이지 노출 |
| 9 | 존재하지 않는 URL 접근 (예: `/abcdef`) | 404 Not Found 페이지 노출 |

### 검증 포인트

- [ ] `handleAuthRouting` 미들웨어 정상 동작
- [ ] `HandleMobileRouting` 미들웨어 정상 동작
- [ ] 면접 상태별 라우트 가드 리다이렉트 정확성
- [ ] 에러 페이지 3종 (403, 404, Interview Not Found) 정상 렌더링
- [ ] 리다이렉트 후 원래 요청 URL 보존 여부

---

## 전체 테스트 실행 순서 (영상 촬영용)

```
영상 1: 온보딩
  └─ 시나리오 1 (로그인 → 회원가입)

영상 2: 핵심 기능
  └─ 시나리오 3 (면접 기록 3단계 파이프라인)
  └─ 시나리오 4 (회고 플로우)
  ※ 기록 → 회고를 하나의 영상으로 이어서 촬영 권장

영상 3: 대시보드
  └─ 시나리오 2 (대시보드 전체 탐색)

영상 4: 안정성
  └─ 시나리오 6 (인증/권한 가드)

영상 5: 모바일
  └─ 시나리오 5 (모바일 전용 플로우)
```

## agent-browser 녹화 명령어

```bash
# 녹화 시작
agent-browser --headed open <URL>
agent-browser record start e2e-recording.webm

# ... 테스트 수행 ...

# 녹화 종료
agent-browser record stop
agent-browser close
```
